---

- name: disable user list
  ansible.builtin.lineinfile:
    path: /etc/gdm3/greeter.dconf-defaults
    regexp: '^disable-user-list='
    insertafter: '\[org/gnome/login-screen\]'
    line: "disable-user-list=true"
  notify: restart gdm

- name: ensure vendor images path exists
  ansible.builtin.file:
    path: /usr/share/images/
    state: directory
    mode: '0755'
    owner: root
    group: root

- name: ensure login background image exists
  ansible.builtin.copy:
    src: kreuz_loginscreen.jpg
    dest: /usr/share/images/kreuz_loginscreen.jpg
    owner: root
    group: root
    mode: '0644'
  notify: restart gdm

- name: configure login background image
  ansible.builtin.lineinfile:
    path: /etc/gdm3/greeter.dconf-defaults
    regexp: '^picture-uri='
    insertafter: '\[org/gnome/desktop/background\]'
    line: "picture-uri='file:///usr/share/images/kreuz_loginscreen.jpg'"
  notify: restart gdm

- name: configure login background image
  ansible.builtin.lineinfile:
    path: /etc/gdm3/greeter.dconf-defaults
    regexp: '^picture-options='
    insertafter: '\[org/gnome/desktop/background\]'
    line: "picture-options='zoom'"
  notify: restart gdm

